{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core/services/personnel-api.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction PersonnelPageComponent_th_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const qual_r2 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(qual_r2);\n  }\n}\nfunction PersonnelPageComponent_tr_12_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const org_r7 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", org_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(org_r7);\n  }\n}\nfunction PersonnelPageComponent_tr_12_td_8_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const qual_opt_r11 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", qual_opt_r11);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(qual_opt_r11);\n  }\n}\nfunction PersonnelPageComponent_tr_12_td_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 18)(1, \"span\", 6);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"select\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function PersonnelPageComponent_tr_12_td_8_Template_select_ngModelChange_3_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const qual_r8 = restoredCtx.$implicit;\n      const person_r3 = i0.ɵɵnextContext().$implicit;\n      return i0.ɵɵresetView(person_r3.quals.set(qual_r8, $event));\n    });\n    i0.ɵɵtemplate(4, PersonnelPageComponent_tr_12_td_8_option_4_Template, 2, 2, \"option\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const qual_r8 = ctx.$implicit;\n    const ctx_r15 = i0.ɵɵnextContext();\n    const person_idx_r4 = ctx_r15.index;\n    const person_r3 = ctx_r15.$implicit;\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r6.isEditable[person_idx_r4] ? \"d-none\" : \"d-block\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(person_r3.quals.get(qual_r8));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r6.isEditable[person_idx_r4] ? \"d-block\" : \"d-none\")(\"ngModel\", person_r3.quals.get(qual_r8));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.qual_options);\n  }\n}\nfunction PersonnelPageComponent_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 5)(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\")(4, \"span\", 6);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"select\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function PersonnelPageComponent_tr_12_Template_select_ngModelChange_6_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const person_r3 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(person_r3.assigned_org = $event);\n    });\n    i0.ɵɵtemplate(7, PersonnelPageComponent_tr_12_option_7_Template, 2, 2, \"option\", 8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(8, PersonnelPageComponent_tr_12_td_8_Template, 5, 5, \"td\", 9);\n    i0.ɵɵelementStart(9, \"td\")(10, \"span\", 6)(11, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function PersonnelPageComponent_tr_12_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const person_idx_r4 = restoredCtx.index;\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.onEdit(person_idx_r4));\n    });\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(12, \"svg\", 11);\n    i0.ɵɵelement(13, \"path\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(14, \"button\", 13);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(15, \"svg\", 14);\n    i0.ɵɵelement(16, \"path\", 15);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(17, \"span\", 6)(18, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function PersonnelPageComponent_tr_12_Template_button_click_18_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const person_idx_r4 = restoredCtx.index;\n      const ctx_r19 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r19.onSave(person_idx_r4));\n    });\n    i0.ɵɵtext(19, \"Save\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const person_r3 = ctx.$implicit;\n    const person_idx_r4 = ctx.index;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"id\", person_r3.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(person_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.isEditable[person_idx_r4] ? \"d-none\" : \"d-block\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(person_r3.assigned_org);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.isEditable[person_idx_r4] ? \"d-block\" : \"d-none\")(\"ngModel\", person_r3.assigned_org);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.assigned_orgs);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.quals);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.isEditable[person_idx_r4] ? \"d-none\" : \"d-block\");\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngClass\", ctx_r1.isEditable[person_idx_r4] ? \"d-block\" : \"d-none\");\n  }\n}\nexport class PersonnelPageComponent {\n  constructor(personAPI) {\n    this.personAPI = personAPI;\n    this.personViewModels = [];\n    this.personModels = new Map();\n    this.isEditable = [];\n    this.quals = ['Operations Supervisor', 'SOF', 'RSU Controller', 'RSU Observer', 'IPC Pilot', 'FPC Pilot', 'FCF Pilot', 'PIT IP', 'SEFE'];\n    this.qual_options = ['', 'X'];\n    this.assigned_orgs = [' ', 'M', 'N', 'O', 'P', 'X'];\n  }\n  ngOnInit() {\n    this.personAPI.getPersonnel().subscribe(persons => {\n      this.personModels = new Map(persons.map(person => [person.id, person]));\n      this.personViewModels = persons.map(person_dto => {\n        const mapped_quals = new Map(this.quals.map(qual => {\n          let val = '';\n          person_dto.quals.forEach(dto_qual => {\n            if (dto_qual == qual) val = 'X';\n            return;\n          });\n          return [qual, val];\n        }));\n        const person_view = {\n          id: person_dto.id,\n          name: person_dto.last_name + ', ' + person_dto.first_name,\n          assigned_org: person_dto.assigned_org,\n          quals: mapped_quals\n        };\n        console.log(person_view.quals);\n        return person_view;\n      });\n      this.personViewModels.sort((a, b) => a.name.localeCompare(b.name));\n      this.isEditable = this.personViewModels.map(() => {\n        return false;\n      });\n    });\n  }\n  onEdit(row) {\n    this.isEditable[row] = true;\n  }\n  onSave(row) {\n    this.isEditable[row] = false;\n    const personVM = this.personViewModels[row];\n    //const updatedQuals: string[] = [];\n    //personVM.quals.forEach((key, value) => {\n    //  if (key === 'X')\n    //    updatedQuals.push(value);\n    //});\n    const updatedQuals = [...personVM.quals].filter(([key, value]) => value == 'X').entries();\n    console.log(updatedQuals);\n    let personModel = this.personModels.get(personVM.id);\n    if (personModel) {\n      personModel.assigned_org = personVM.assigned_org;\n      //personModel.quals = updatedQuals;\n      this.personAPI.update(personModel).subscribe();\n    }\n  }\n}\nPersonnelPageComponent.ɵfac = function PersonnelPageComponent_Factory(t) {\n  return new (t || PersonnelPageComponent)(i0.ɵɵdirectiveInject(i1.PersonnelAPIService));\n};\nPersonnelPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PersonnelPageComponent,\n  selectors: [[\"sc-personnel-page\"]],\n  decls: 13,\n  vars: 2,\n  consts: [[1, \"table\", \"table-sm\", \"table-bordered\", \"table-hover\", \"table-striped\"], [\"scope\", \"col\"], [\"scope\", \"col\", \"class\", \"rotate\", 4, \"ngFor\", \"ngForOf\"], [3, \"id\", 4, \"ngFor\", \"ngForOf\"], [\"scope\", \"col\", 1, \"rotate\"], [3, \"id\"], [3, \"ngClass\"], [1, \"form-select\", 3, \"ngClass\", \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"qual\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"button\", 1, \"edit-btn\", \"btn\", \"btn-outline-secondary\", 3, \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"16\", \"height\", \"16\", \"fill\", \"currentColor\", \"viewBox\", \"0 0 16 16\", 1, \"bi\", \"bi-pencil-fill\"], [\"d\", \"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"], [\"type\", \"button\", 1, \"btn\", \"btn-outline-danger\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"16\", \"height\", \"16\", \"fill\", \"currentColor\", \"viewBox\", \"0 0 16 16\", 1, \"bi\", \"bi-trash-fill\"], [\"d\", \"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z\"], [\"type\", \"button\", 1, \"save-btn\", \"btn\", \"btn-primary\", 3, \"click\"], [3, \"value\"], [1, \"qual\"]],\n  template: function PersonnelPageComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h1\");\n      i0.ɵɵtext(1, \"Personnel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"table\", 0)(3, \"thead\")(4, \"th\", 1);\n      i0.ɵɵtext(5, \"Name\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"th\", 1);\n      i0.ɵɵtext(7, \"Assigned Flight\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(8, PersonnelPageComponent_th_8_Template, 2, 1, \"th\", 2);\n      i0.ɵɵelementStart(9, \"th\");\n      i0.ɵɵtext(10, \"Options\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(11, \"tbody\");\n      i0.ɵɵtemplate(12, PersonnelPageComponent_tr_12_Template, 20, 10, \"tr\", 3);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngForOf\", ctx.quals);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.personViewModels);\n    }\n  },\n  dependencies: [i2.NgClass, i2.NgForOf, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n  styles: [\"th.rotate[_ngcontent-%COMP%] {\\n    max-width: 1.5em;\\n    min-width: 1.5em;\\n    writing-mode: vertical-rl;\\n}\\n\\n.qual[_ngcontent-%COMP%] {\\n    max-width: 1.5em;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGVyc29ubmVsL3BlcnNvbm5lbC1wYWdlL3BlcnNvbm5lbC1wYWdlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxnQkFBZ0I7SUFDaEIsZ0JBQWdCO0lBQ2hCLHlCQUF5QjtBQUM3Qjs7QUFFQTtJQUNJLGdCQUFnQjtBQUNwQiIsInNvdXJjZXNDb250ZW50IjpbInRoLnJvdGF0ZSB7XG4gICAgbWF4LXdpZHRoOiAxLjVlbTtcbiAgICBtaW4td2lkdGg6IDEuNWVtO1xuICAgIHdyaXRpbmctbW9kZTogdmVydGljYWwtcmw7XG59XG5cbi5xdWFsIHtcbiAgICBtYXgtd2lkdGg6IDEuNWVtO1xufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":";;;;;;IAKQA,6BAA0D;IAAAA,YAAU;IAAAA,iBAAK;;;;IAAfA,eAAU;IAAVA,6BAAU;;;;;IASxDA,kCAA4D;IAAAA,YAAS;IAAAA,iBAAS;;;;IAApCA,yCAAiB;IAACA,eAAS;IAATA,4BAAS;;;;;IAMrEA,kCAAqE;IAAAA,YAAc;IAAAA,iBAAS;;;;IAA9CA,+CAAsB;IAACA,eAAc;IAAdA,kCAAc;;;;;;IAH3FA,8BAA+D;IACKA,YAA4B;IAAAA,iBAAO;IACnGA,iCAA0K;IAAjDA;MAAA;MAAA;MAAA;MAAA,OAAiBA,mDAA8B;IAAA,EAAC;IACrKA,wFAA4F;IAChGA,iBAAS;;;;;;;;IAHHA,eAAyD;IAAzDA,iFAAyD;IAACA,eAA4B;IAA5BA,kDAA4B;IACpFA,eAAyD;IAAzDA,iFAAyD;IAChCA,eAAe;IAAfA,6CAAe;;;;;;IAXxDA,6BAAkF;IAC1EA,YAAiB;IAAAA,iBAAK;IAC1BA,0BAAI;IACgEA,YAAyB;IAAAA,iBAAO;IAChGA,iCAAwH;IAAlCA;MAAA;MAAA;MAAA,OAAaA,+CAC9G;IAAA,EADkI;IACnHA,mFAA8E;IAClFA,iBAAS;IAEbA,2EAKK;IACLA,0BAAI;IAEqEA;MAAA;MAAA;MAAA;MAAA,OAASA,4CAAkB;IAAA,EAAC;IACzFA,mBAAiI;IAAjIA,gCAAiI;IAC7HA,4BAAkc;IACtcA,iBAAM;IAEVA,oBAAqD;IAArDA,mCAAqD;IACjDA,mBAAgI;IAAhIA,gCAAgI;IAC5HA,4BAAsT;IAC1TA,iBAAM;IAGdA,oBAAgE;IAAhEA,gCAAgE;IACLA;MAAA;MAAA;MAAA;MAAA,OAASA,4CAAkB;IAAA,EAAC;IAACA,qBAAI;IAAAA,iBAAS;;;;;;IA5B5CA,iCAAgB;IACzEA,eAAiB;IAAjBA,oCAAiB;IAEXA,eAAyD;IAAzDA,iFAAyD;IAACA,eAAyB;IAAzBA,4CAAyB;IACjFA,eAAyD;IAAzDA,iFAAyD;IACrCA,eAAgB;IAAhBA,8CAAgB;IAG3BA,eAAU;IAAVA,sCAAU;IAOrBA,eAAyD;IAAzDA,iFAAyD;IAYzDA,eAAyD;IAAzDA,iFAAyD;;;AC1B/E,OAAM,MAAOC,sBAAsB;EAQjCC,YAAoBC,SAA8B;IAA9B,cAAS,GAATA,SAAS;IAP7B,qBAAgB,GAAiB,EAAE;IACnC,iBAAY,GAAwB,IAAIC,GAAG,EAAkB;IAI7D,eAAU,GAAc,EAAE;IAIxB,IAAI,CAACC,KAAK,GAAG,CACX,uBAAuB,EAAE,KAAK,EAAE,gBAAgB,EAAE,cAAc,EAAE,WAAW,EAAE,WAAW,EAAE,WAAW,EAAE,QAAQ,EAAE,MAAM,CAC1H;IAED,IAAI,CAACC,YAAY,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC;IAE7B,IAAI,CAACC,aAAa,GAAG,CACnB,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAC7B;EACH;EAEAC,QAAQ;IACN,IAAI,CAACL,SAAS,CAACM,YAAY,EAAE,CAACC,SAAS,CAACC,OAAO,IAAG;MAChD,IAAI,CAACC,YAAY,GAAG,IAAIR,GAAG,CAACO,OAAO,CAACE,GAAG,CAACC,MAAM,IAAI,CAACA,MAAM,CAACC,EAAE,EAAED,MAAM,CAAC,CAAC,CAAC;MAEvE,IAAI,CAACE,gBAAgB,GAAGL,OAAO,CAACE,GAAG,CAACI,UAAU,IAAG;QAE/C,MAAMC,YAAY,GAAG,IAAId,GAAG,CAAC,IAAI,CAACC,KAAK,CAACQ,GAAG,CAACM,IAAI,IAAG;UACjD,IAAIC,GAAG,GAAG,EAAE;UAEZH,UAAU,CAACZ,KAAK,CAACgB,OAAO,CAACC,QAAQ,IAAG;YAClC,IAAIA,QAAQ,IAAIH,IAAI,EAClBC,GAAG,GAAG,GAAG;YACT;UACJ,CAAC,CAAC;UAEF,OAAO,CAACD,IAAI,EAAEC,GAAG,CAAC;QACpB,CAAC,CAAC,CAAC;QAEH,MAAMG,WAAW,GAAe;UAC9BR,EAAE,EAAEE,UAAU,CAACF,EAAE;UACjBS,IAAI,EAAEP,UAAU,CAACQ,SAAS,GAAG,IAAI,GAAGR,UAAU,CAACS,UAAU;UACzDC,YAAY,EAAEV,UAAU,CAACU,YAAY;UACrCtB,KAAK,EAAEa;SACR;QAEDU,OAAO,CAACC,GAAG,CAACN,WAAW,CAAClB,KAAK,CAAC;QAC9B,OAAOkB,WAAW;MACpB,CAAC,CAAC;MAEF,IAAI,CAACP,gBAAgB,CAACc,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACP,IAAI,CAACS,aAAa,CAACD,CAAC,CAACR,IAAI,CAAC,CAAC;MAElE,IAAI,CAACU,UAAU,GAAG,IAAI,CAAClB,gBAAgB,CAACH,GAAG,CAAC,MAAK;QAC/C,OAAO,KAAK;MACd,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAsB,MAAM,CAACC,GAAW;IAChB,IAAI,CAACF,UAAU,CAACE,GAAG,CAAC,GAAG,IAAI;EAC7B;EAEAC,MAAM,CAACD,GAAW;IAChB,IAAI,CAACF,UAAU,CAACE,GAAG,CAAC,GAAG,KAAK;IAE5B,MAAME,QAAQ,GAAG,IAAI,CAACtB,gBAAgB,CAACoB,GAAG,CAAC;IAE3C;IACA;IACA;IACA;IACA;IAEA,MAAMG,YAAY,GAAG,CAAC,GAAGD,QAAQ,CAACjC,KAAK,CAAC,CAACmC,MAAM,CAAC,CAAC,CAACC,GAAG,EAAEC,KAAK,CAAC,KAAKA,KAAK,IAAI,GAAG,CAAC,CAACC,OAAO,EAAE;IACzFf,OAAO,CAACC,GAAG,CAACU,YAAY,CAAC;IAEzB,IAAIK,WAAW,GAAG,IAAI,CAAChC,YAAY,CAACiC,GAAG,CAACP,QAAQ,CAACvB,EAAE,CAAC;IACpD,IAAI6B,WAAW,EAAE;MACfA,WAAW,CAACjB,YAAY,GAAGW,QAAQ,CAACX,YAAY;MAChD;MACA,IAAI,CAACxB,SAAS,CAAC2C,MAAM,CAACF,WAAW,CAAC,CAAClC,SAAS,EAAE;;EAElD;;;mBAlFWT,sBAAsB;AAAA;;QAAtBA,sBAAsB;EAAA8C;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MDVnCnD,0BAAI;MAAAA,yBAAS;MAAAA,iBAAK;MAClBA,gCAAuE;MAE/CA,oBAAI;MAAAA,iBAAK;MACzBA,6BAAgB;MAAAA,+BAAe;MAAAA,iBAAK;MACpCA,qEAAyE;MACzEA,0BAAI;MAAAA,wBAAO;MAAAA,iBAAK;MAEpBA,8BAAO;MACHA,yEA+BK;MACTA,iBAAQ;;;MApCiBA,eAAQ;MAARA,mCAAQ;MAINA,eAAqB;MAArBA,8CAAqB","names":["i0","PersonnelPageComponent","constructor","personAPI","Map","quals","qual_options","assigned_orgs","ngOnInit","getPersonnel","subscribe","persons","personModels","map","person","id","personViewModels","person_dto","mapped_quals","qual","val","forEach","dto_qual","person_view","name","last_name","first_name","assigned_org","console","log","sort","a","b","localeCompare","isEditable","onEdit","row","onSave","personVM","updatedQuals","filter","key","value","entries","personModel","get","update","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/keelerjr/dev/sparkcell-autoscheduler/web/src/app/personnel/personnel-page/personnel-page.component.html","/home/keelerjr/dev/sparkcell-autoscheduler/web/src/app/personnel/personnel-page/personnel-page.component.ts"],"sourcesContent":["<h1>Personnel</h1>\n<table class=\"table table-sm table-bordered table-hover table-striped\">\n    <thead>\n        <th scope=\"col\">Name</th>\n        <th scope=\"col\">Assigned Flight</th>\n        <th *ngFor=\"let qual of quals\" scope=\"col\" class=\"rotate\">{{ qual }}</th>\n        <th>Options</th>\n    </thead>\n    <tbody>\n        <tr *ngFor=\"let person of personViewModels; index as person_idx\" [id]=\"person.id\">\n            <td>{{ person.name }}</td>\n            <td>\n                <span [ngClass]=\"isEditable[person_idx] ? 'd-none' : 'd-block'\">{{ person.assigned_org }}</span>\n                <select [ngClass]=\"isEditable[person_idx] ? 'd-block' : 'd-none'\" class=\"form-select\" [(ngModel)]=\"person.assigned_org\">\n                    <option *ngFor=\"let org of assigned_orgs\" value=\"{{ org }}\">{{ org }}</option>\n                </select>\n            </td>\n            <td *ngFor=\"let qual of quals; index as qual_idx\" class=\"qual\">\n                <span [ngClass]=\"isEditable[person_idx] ? 'd-none' : 'd-block'\">{{ person.quals.get(qual) }}</span>\n                <select [ngClass]=\"isEditable[person_idx] ? 'd-block' : 'd-none'\" class=\"form-select\" [ngModel]=\"person.quals.get(qual)\" (ngModelChange)=\"person.quals.set(qual, $event)\">\n                    <option *ngFor=\"let qual_opt of qual_options\" value=\"{{ qual_opt }}\">{{ qual_opt }}</option>\n                </select>\n            </td>\n            <td>\n                <span [ngClass]=\"isEditable[person_idx] ? 'd-none' : 'd-block'\">\n                    <button type=\"button\" class=\"edit-btn btn btn-outline-secondary\" (click)=\"onEdit(person_idx)\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-pencil-fill\" viewBox=\"0 0 16 16\">\n                            <path d=\"M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z\"/>\n                        </svg>\n                    </button>\n                    <button type=\"button\" class=\"btn btn-outline-danger\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-trash-fill\" viewBox=\"0 0 16 16\">\n                            <path d=\"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z\"/>\n                        </svg>\n                    </button>\n                </span>\n                <span [ngClass]=\"isEditable[person_idx] ? 'd-block' : 'd-none'\">\n                    <button type=\"button\" class=\"save-btn btn btn-primary\" (click)=\"onSave(person_idx)\">Save</button>\n                </span>\n            </td>\n        </tr>\n    </tbody>\n</table>\n","import { Component } from '@angular/core';\nimport { Person } from 'src/app/core/models/person.model';\nimport { PersonnelAPIService } from 'src/app/core/services/personnel-api.service';\nimport { PersonView } from '../shared/personview.model';\n\n@Component({\n  selector: 'sc-personnel-page',\n  templateUrl: './personnel-page.component.html',\n  styleUrls: ['./personnel-page.component.css']\n})\nexport class PersonnelPageComponent {\n  personViewModels: PersonView[] = [];\n  personModels: Map<number, Person> = new Map<number, Person>();\n  assigned_orgs: string[];\n  quals: string[];\n  qual_options: string[];\n  isEditable: boolean[] = [];\n\n  constructor(private personAPI: PersonnelAPIService) {\n\n    this.quals = [\n      'Operations Supervisor', 'SOF', 'RSU Controller', 'RSU Observer', 'IPC Pilot', 'FPC Pilot', 'FCF Pilot', 'PIT IP', 'SEFE'\n    ];\n\n    this.qual_options = ['', 'X']\n\n    this.assigned_orgs = [\n      ' ', 'M', 'N', 'O', 'P', 'X'\n    ];\n  }\n\n  ngOnInit() {\n    this.personAPI.getPersonnel().subscribe(persons => {\n      this.personModels = new Map(persons.map(person => [person.id, person]));\n\n      this.personViewModels = persons.map(person_dto => {\n\n        const mapped_quals = new Map(this.quals.map(qual => {\n          let val = '';\n\n          person_dto.quals.forEach(dto_qual => {\n            if (dto_qual == qual)\n              val = 'X';\n              return;\n          });\n\n          return [qual, val] \n        }));\n\n        const person_view: PersonView = {\n          id: person_dto.id,\n          name: person_dto.last_name + ', ' + person_dto.first_name,\n          assigned_org: person_dto.assigned_org,\n          quals: mapped_quals\n        };\n\n        console.log(person_view.quals);\n        return person_view;\n      });\n\n      this.personViewModels.sort((a, b) => a.name.localeCompare(b.name))\n\n      this.isEditable = this.personViewModels.map(() => {\n        return false;\n      });\n    });\n  }\n\n  onEdit(row: number) {\n    this.isEditable[row] = true;\n  }\n\n  onSave(row: number) {\n    this.isEditable[row] = false;\n\n    const personVM = this.personViewModels[row];\n\n    //const updatedQuals: string[] = [];\n    //personVM.quals.forEach((key, value) => {\n    //  if (key === 'X')\n    //    updatedQuals.push(value);\n    //});\n\n    const updatedQuals = [...personVM.quals].filter(([key, value]) => value == 'X').entries();\n    console.log(updatedQuals);\n\n    let personModel = this.personModels.get(personVM.id);\n    if (personModel) {\n      personModel.assigned_org = personVM.assigned_org;\n      //personModel.quals = updatedQuals;\n      this.personAPI.update(personModel).subscribe();\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}